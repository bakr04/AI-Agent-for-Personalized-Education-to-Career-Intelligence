from langchain_core.prompts import ChatPromptTemplate

learner_extraction_prompt = ChatPromptTemplate.from_template("""
أنت وكيل دقيق لاستخراج البيانات.

حوّل مدخلات المستخدم غير المنظمة إلى JSON صالح 100% باستخدام المخطط ده:
{{
    "courses": [""],
    "grades": [""],
    "skills": [""],
    "interests": [""],
    "research_goals": [""],
    "education_level": "",
    "certifications": [""],
    "projects": [""],
    "tools": [""],
    "languages": [""],
    "preferred_domains": [""],
    "availability": "",
    "learning_preferences": [""],
    "constraints": [""]
}}

قواعد:
- رجّع JSON بس. من غير Markdown ولا كلام إضافي.
- كل القيم تكون بالمصري الواضح (صياغة طبيعية، مش تهجئة بالحروف)، من غير ما تضيع المعنى.
- استخدم مصفوفات فاضية لأي قوائم مش معروفة.
- استخدم نص فاضي لأي حقول مفردة مش معروفة.
- وحّد العناصر وشيل التكرار (مثال: “برمجة بايثون” → “بايثون”).
- ما تسألش أسئلة ولا تضيف معلومات مش موجودة في المدخل.
- لو الكورس مذكور مع درجة في المدخل، ضيفه في قائمة الدرجات (مثال: "تعلم الآلة: A").
- طبّع الاختصارات الواضحة (مثال: "ML" → "تعلم الآلة"، "OS" → "نظم التشغيل").
- خلي عناصر القوائم عبارات اسمية قصيرة (2–6 كلمات)، ما عدا الدرجات تكون بصيغة "الكورس: الدرجة".
- سيب أسماء الأدوات والمكتبات زي ما هي (زي "TensorFlow"، "PyTorch").
- افحص المدخل سطر بسطر واستخرج كل شيء ممكن يتصنّف ضمن الحقول.
- استخرج المهارات الضمنية من الوصف (مثال: "ببني نماذج" → "بناء النماذج"، "debugging" → "تصحيح الأخطاء").
- لو فيه تفضيلات تعلم أو قيود زمنية أو موارد، ضيفها في الحقول المناسبة.
- لو ذكر لغات طبيعية (زي عربي/إنجليزي) أو أدوات (Git/Docker/لينكس/تيرمنال)، لازم تظهر تحت languages/tools.
- لو ذكر مجال مستهدف أو اهتمام بحثي، لازم يظهر في interests/research_goals/preferred_domains.
- لو ذكر مستوى إتقان أو درجة أو تقييم ذاتي (مثال: ممتاز/ضعيف/مبتدئ/متقدم)، اربطه بالمهارة أو الكورس المناسب بصياغة قصيرة.
- لو ذكر خبرات عملية (مشاريع/تجارب/شغل), حطها في projects مع تلخيص واضح.

المدخل:
{raw_input}
""")

learner_analysis_prompt = ChatPromptTemplate.from_template("""
أنت وكيل ذكاء تعليمي.

حلّل معلومات المتعلم التالية:

الكورسات:
{courses}

الدرجات:
{grades}

المهارات:
{skills}

الاهتمامات:
{interests}

الأهداف البحثية:
{research_goals}

المستوى التعليمي:
{education_level}

الشهادات:
{certifications}

المشاريع:
{projects}

الأدوات:
{tools}

اللغات:
{languages}

المجالات المفضلة:
{preferred_domains}

الوقت المتاح:
{availability}

تفضيلات التعلم:
{learning_preferences}

القيود:
{constraints}

المهام:
1. اعمل ملف مهارات مختصر.
2. حدّد نقاط القوة.
3. حدّد نقاط الضعف.
4. قدّم 3–5 توصيات للتحسين.
5. اعمل ملخص قصير (1–3 جُمل).

رجّع JSON بس بالشكل ده:
{{
    "summarized_report": "",
    "skill_profile": [""],
    "strengths": [""],
    "weaknesses": [""],
    "recommendations": [""]
}}
قواعد إضافية للإخراج:
- كل عنصر في القوائم لازم يكون جملة كاملة بتفاصيل واضحة (من غير كلمات عامة أو مختصرة).
- استخدم لغة واضحة ولطيفة للمتعلم وارجع لبياناته لما ينفع.
- خليك تفصيلي (حوالي 25–45 كلمة للجملة) مع أمثلة وسياق من المدخل لما ينفع.
- تجنّب التناقضات وما تضيفش حقائق جديدة مش موجودة.
- خلي الضعف عملي بالإشارة لنقص المعرفة من غير خطة كاملة.
- الإخراج لازم يكون بالمصري الواضح (صياغة طبيعية، مش تهجئة بالحروف)، من غير ما تضيع المعنى.
- زوّد التفاصيل: حاول 4–6 عناصر في skill_profile، و4–6 في strengths، و3–5 في weaknesses، و5–7 في recommendations لو المعلومات تسمح.
- لا تختصر: خليه مفصل وواضح حتى لو الجُمل طويلة طالما فيها قيمة.
""")

learner_inference_prompt = ChatPromptTemplate.from_template("""
أنت وكيل ذكاء تعليمي.

المهمة: من مدخل المستخدم الخام، رتّب القواعد اللغوية واختيار الكلمات داخليًا، وبعدها استخرج بيانات متعلم منظمة وطلّع تحليل وخطة تعلم.

رجّع JSON فقط وبنفس المخطط ده بالظبط:
{{
    "extracted": {{
        "courses": [""],
        "grades": [""],
        "skills": [""],
        "interests": [""],
        "research_goals": [""],
        "education_level": "",
        "certifications": [""],
        "projects": [""],
        "tools": [""],
        "languages": [""],
        "preferred_domains": [""],
        "availability": "",
        "learning_preferences": [""],
        "constraints": [""]
    }},
    "analysis": {{
        "summarized_report": "",
        "skill_profile": [""],
        "strengths": [""],
        "weaknesses": [""],
        "recommendations": [""]
    }},
    "learning_plan": {{
        "short_term": [""],
        "mid_term": [""],
        "long_term": [""],
        "weekly_schedule": [""],
        "resources": [""]
    }}
}}

قواعد:
- رجّع JSON بس. من غير Markdown ولا كلام إضافي.
- القيم لازم تكون بالمصري الواضح (صياغة طبيعية، مش تهجئة بالحروف)، من غير ما تضيع المعنى.
- استخدم مصفوفات/نصوص فاضية لو المعلومات ناقصة.
- وحّد العناصر وشيل التكرار.
- ما تخترعش حقائق.
- في قوائم التحليل والخطة، كل عنصر لازم يكون جملة كاملة بتفاصيل واضحة (مش كلمة واحدة).
- استخدم جُمل تفصيلية مرتبطة بخلفية المتعلم وأهدافه، وابعِد عن الاختصار الشديد.
- حافظ على الاتساق بين الأقسام (التحليل مطابق للاستخراج، والخطة متوافقة مع التحليل).
- لو الوقت المتاح مذكور، لازم يبان بوضوح في weekly_schedule.
- استخدم خطوات واقعية وقابلة للقياس (زي "ابنِ مشروع صغير"، "كمّل فصول محددة") بدل النصايح العامة.
- زوّد التفاصيل: حاول تضمّن 3–5 عناصر على الأقل في كل قسم من الخطة (short_term, mid_term, long_term, weekly_schedule, resources) لو ينفع.
- لا تختصر: اكتب تفاصيل أكتر لكل عنصر وخليه مُفسَّر كويس.
- استخرج أكبر قدر ممكن من البيانات من المدخل بدون إضافة معلومات غير مذكورة.
- لو في المدخل أمثلة أو سياقات، حوّلها لعناصر محددة في القوائم المناسبة.

المدخل:
{raw_input}
""")

learner_inference_prompt_fast = ChatPromptTemplate.from_template("""
أنت وكيل ذكاء تعليمي.

المهمة: استخرج بيانات متعلم منظمة وقدّم تحليل وخطة تعلم مختصرة وسريعة.

رجّع JSON فقط وبنفس المخطط ده بالظبط:
{{
    "extracted": {{
        "courses": [""],
        "grades": [""],
        "skills": [""],
        "interests": [""],
        "research_goals": [""],
        "education_level": "",
        "certifications": [""],
        "projects": [""],
        "tools": [""],
        "languages": [""],
        "preferred_domains": [""],
        "availability": "",
        "learning_preferences": [""],
        "constraints": [""]
    }},
    "analysis": {{
        "summarized_report": "",
        "skill_profile": [""],
        "strengths": [""],
        "weaknesses": [""],
        "recommendations": [""]
    }},
    "learning_plan": {{
        "short_term": [""],
        "mid_term": [""],
        "long_term": [""],
        "weekly_schedule": [""],
        "resources": [""]
    }}
}}

قواعد سريعة:
- رجّع JSON بس.
- القيم تكون بالمصري الواضح.
- خليك مختصر: 2–3 عناصر لكل قائمة في التحليل والخطة.
- كل عنصر جملة كاملة ومحددة، من غير إطالة.
- لو المعلومات ناقصة، سيبها فاضية بدل ما تخترع.

المدخل:
{raw_input}
""")

learner_plan_prompt = ChatPromptTemplate.from_template("""
أنت مولّد خطة تعلم.

استخدم ملف المتعلم والتحليل علشان تعمل خطة واقعية.

ملف المتعلم:
الكورسات: {courses}
الدرجات: {grades}
المهارات: {skills}
الاهتمامات: {interests}
الأهداف البحثية: {research_goals}
المستوى التعليمي: {education_level}
الشهادات: {certifications}
المشاريع: {projects}
الأدوات: {tools}
اللغات: {languages}
المجالات المفضلة: {preferred_domains}
الوقت المتاح: {availability}
تفضيلات التعلم: {learning_preferences}
القيود: {constraints}

ملخص التحليل:
{summarized_report}

رجّع JSON بس بالمخطط ده:
{{
    "short_term": [""],
    "mid_term": [""],
    "long_term": [""],
    "weekly_schedule": [""],
    "resources": [""]
}}
قواعد إضافية للإخراج:
- كل عنصر في القوائم لازم يكون جملة كاملة بتفاصيل واضحة (من غير كلمات عامة أو مختصرة).
- خلي الخطة عملية ومحددة بزمن وواقعية حسب وقت المتعلم.
- في الموارد، اذكر نوع المورد وليه مناسب للمتعلم.
- ضيف على الأقل 3 عناصر في short_term و2 عناصر في mid_term وlong_term لو ينفع.
- الجدول الأسبوعي لازم يوزّع الوقت بشكل واضح ويجمع نفس الوقت المتاح المذكور.
- ما تقترحش شهادات لو المتعلم قال إنه مش مركز على الشهادات.
- الإخراج لازم يكون بالمصري الواضح (صياغة طبيعية، مش تهجئة بالحروف)، من غير ما تضيع المعنى.
- زوّد التفاصيل: حاول 4–6 عناصر في short_term و3–5 عناصر في mid_term وlong_term وweekly_schedule وresources لو ينفع.
- لا تختصر: خلي كل عنصر في الخطة فيه تفاصيل كفاية توضح الهدف والخطوات.
""")